<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>.:!:.</title>
		<style type="text/css" media="screen">
			body {
				margin:0;
				padding:0;
				font-family:"Lucida Grande", Lucida, Verdana, sans-serif;
			}
			a {
				color:#DDD;
				text-decoration:none;
			}
			a:hover {
				color:#FFF;
				text-decoration:none;
			}
		</style>
	</head>
	<body id="index" onload="init()">
        <script type="text/javascript" charset="utf-8">
            function init(){var modules={};modules.Size=(function initSize(mods){var construct=function(width,height){width=ifndefInit(width,0);height=ifndefInit(height,0);var self={width:width,height:height};self.isEqualTo=function(size){return size.width==self.width&&size.height==size.height};return self};return{construct:construct}})(modules);(function blankCallback(){})(modules);modules.Point=(function initPoint(mods){var construct=function(xx,yy){xx=ifndefInit(xx,0);yy=ifndefInit(yy,0);var self={x:xx,y:yy,};self.copy=function Point_copy(){return construct(self.x,self.y)};self.isEqualTo=function(point){return point.x==self.x&&point.y==self.y};self.distanceTo=function(point){var dx=point.x-self.x;var dy=point.y-self.y;if(dx==0&&dy==0){return 0}return Math.sqrt(dx*dx+dy*dy)};self.closer=function(p1,p2){var self=Point.construct(self.x,self.y);var d1=self.distanceTo(p1);var d2=self.distanceTo(p2);var rp;if(d1<d2){return p1}return p2};self.toString=function(){return"[object Point("+self.x+","+self.y+")]"};return self};return{construct:construct}})(modules);(function blankCallback(){})(modules);modules.global=(function(){window.defined=function(variable){if(variable===null){return false}if(variable===undefined){return false}return true};window.ifndefInit=function(variable,value){variable=defined(variable)?variable:value;return variable};window.ifndefInitNum=function(variable,value){variable=defined(variable)?variable:value;if(isNaN(variable)){if(isNaN(value)){console.error("value",value.toString(),"is not a number...");return 0}else{variable=value}}return variable};window.ifndefInitObj=function(obj,defaultObj){obj=obj||defaultObj;for(key in defaultObj){if(!(key in obj)){obj[key]=defaultObj[key]}}return obj};window.assert=(function(){var passes=0,fails=0;var failStrings=[];var tests=[];return{eq:function(uno,dos,statement){var testFunc=function test(testObj){console.log(tests.length,statement);console.log("	asserting "+uno+" == "+dos);if(uno!==dos){var failString="("+uno+" !== "+dos+") "+assert.suite+" - "+statement;console.log("	ERROR "+failString);testObj.failString=failString;return false}return true};var testObj={test:testFunc,arguments:arguments};testObj.success=testObj.test(testObj);tests.push(testObj)},stat:function(){console.log("\n");var fails=0;for(var i=0;i<tests.length;i++){var test=tests[i];if("failString" in test){if(fails==0){console.log("FAIL...")}console.log("	"+i+" "+test.failString);fails++}}if(fails==0){console.log("OKAY!")}console.log("passes:"+(tests.length-fails)+" fails:"+fails)},suite:"Generic Tests",tests:tests}})();window.animateWithFunction=function(animationFunction){var request=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.onRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,1000/12)};var animate=function(time){animationFunction(time);request(animate)};request(animate)};(function Global_setupLogging(){if(window.console){return}window.console={};window.console.log=function(){};window.console.trace=function(){}})();(function Global_implementObjectCreate(){if(typeof Object.create!=="function"){Object.create=function(o){function F(){}F.prototype=o;return new F()}}})();(function Global_implementObjectAddins(){if(typeof Object.addinWithoutOverriding!=="function"){Object.addinWithoutOverriding=function(base,addin){for(key in addin){if(!(key in base)&&!(base.hasOwnProperty(key))){base[key]=addin[key]}}return base}}if(typeof Object.addin!=="function"){Object.addin=function(base,addin){for(key in addin){base[key]=addin[key]}return base}}})();return{}})(modules);(function blankCallback(){})(modules);modules.Rectangle=(function initRectangle(mods){var Point=mods.Point;var Size=mods.Size;var construct=function(x,y,width,height){var self={origin:Point.construct(x,y),size:Size.construct(width,height)};self.isEqualTo=function(rectangle){return self.origin.isEqualTo(rectangle.origin)&&self.size.isEqualTo(rectangle.size)};self.copy=function(){return construct(self.origin.x,self.origin.y,self.size.width,self.size.height)};self.left=function(){return self.origin.x};self.top=function(){return self.origin.y};self.right=function(){return self.origin.x+self.size.width};self.bottom=function(){return self.origin.y+self.size.height};self.area=function(){return self.size.width*self.size.height};self.containsPoint=function(point){return point.x>=self.left()&&point.x<=self.right()&&point.y>=self.top()&&point.y<=self.bottom()};self.union=function(rectangle){var left=Math.min(self.left(),rectangle.left());var top=Math.min(self.top(),rectangle.top());var width=Math.max(self.right(),rectangle.right())-left;var height=Math.max(self.bottom(),rectangle.bottom())-top;return construct(left,top,width,height)};self.section=function(cutObj){cutObj=ifndefInitObj(cutObj,{verticallyAt:[],horizontallyAt:[]});cutObj.verticallyAt.unshift(0);cutObj.verticallyAt.push(self.size.width);cutObj.horizontallyAt.unshift(0);cutObj.horizontallyAt.push(self.size.height);var verticals=(cutObj.verticallyAt.length-1);var horizontals=(cutObj.horizontallyAt.length-1);var sections=[];var x,y,w,h;for(var j=0;j<horizontals;j++){for(var i=0;i<verticals;i++){x=self.left()+cutObj.verticallyAt[i];y=self.top()+cutObj.horizontallyAt[j];w=cutObj.verticallyAt[i+1]-cutObj.verticallyAt[i];h=cutObj.horizontallyAt[j+1]-cutObj.horizontallyAt[j];var section=construct(x,y,w,h);sections.push(section)}}return sections};self.toString=function(){return"[object Rectangle(x:"+self.origin.x+" y:"+self.origin.y+" w:"+self.size.width+" h:"+self.size.height+")]"};return self};var constructFromTwoPoints=function(p1,p2){var x,y,w,h;x=0;y=0;w=0;h=0;if(p1.x<p2.x){x=p1.x;w=p2.x-p1.x}else{x=p2.x;w=p1.x-p2.x}if(p1.y<p2.y){y=p1.y;h=p2.y-p1.y}else{y=p2.y;h=p1.y-p2.y}return construct(x,y,w,h)};return{construct:construct,constructFromTwoPoints:constructFromTwoPoints}})(modules);(function blankCallback(){})(modules);modules.Event=(function initEvent(){var __instances=0;var construct=function Event_construct(initObj){initObj=ifndefInitObj(initObj,{type:"genericEvent",data:{}});var self={id:"Event-"+__instances++,type:initObj.type,data:initObj.data};return self};var Dispatcher=(function createEvent_Dispatcher(){var __instances=0;var construct=function Event_Dispatcher_construct(){var self={id:"EventDispatcher-"+__instances++,listeners:{},};self.numberOfListeners=function Event_Dispatcher_numberOfListeners(){var total=0;for(eventType in self.listeners){total+=self.listeners[eventType].length}return total};self.on=function Event_Dispatcher_on(type,callback){if(type in self.listeners&&typeof callback==="function"){self.listeners[type].push(callback)}else{self.listeners[type]=[callback]}};self.off=function Event_Dispatcher_off(type,callback){if(type in self.listeners){var n=self.listeners[type].length;for(var i=0;i<n;i++){if(self.listeners[type][i]===callback){self.listeners[type].splice(i,1);if(self.listeners[type].length===0){delete self.listeners[type]}return}}}};self.dispatch=function Event_Dispatcher_dispatch(event,target){for(var i=0;(event.type in self.listeners)&&i<self.listeners[event.type].length;i++){var dispatchFunc=self.listeners[event.type][i];dispatchFunc(event,target)}};self.isListeningFor=function Event_Dispatcher_isListeningFor(type){return type in self.listeners};return self};return{construct:construct}})();return{construct:construct,Dispatcher:Dispatcher}})(modules);(function blankCallback(){})(modules);modules.Display=(function initDisplay(mods){var Event=mods.Event;var Point=mods.Point;var Rectangle=mods.Rectangle;var events={onclick:"onclick",onmousedown:"onmousedown",onmouseup:"onmouseup",onmousemove:"onmousemove",onkeypress:"onkeypress"};var dimensions={aggregateTranslation:Point.construct()};var DrawObject=(function createDrawObject(){var __instances=0;var construct=function Display_DrawObject_construct(initObj){initObj=ifndefInitObj(initObj,{frame:Rectangle.construct(),dispatcher:Event.Dispatcher.construct(),drawQueue:[],context:null,mousedOver:false});var self=Object.addin({id:"DrawObject-"+__instances++,},initObj);self.draw=function Display_DrawObject_draw(){var n=self.drawQueue.length;for(var i=0;i<n;i++){self.drawQueue[i](self)}};self.setDrawFuncIndex=function Display_DrawObject_setDrawFuncIndex(drawFunc,ndx){for(var i=0;i<self.drawQueue;i++){var foundAt=self.drawQueue.indexOf(drawFunc);if(foundAt>=0){self.drawQueue.splice(foundAt,1)}self.drawQueue.splice(ndx,0,drawFunc)}};self.addDrawFunc=function Display_DrawObject_addDrawFunc(drawFunc,ndx){if(ndx){setDrawFuncIndex(drawFunc,ndx)}else{self.drawQueue.push(drawFunc)}};self.removeDrawFunc=function Display_DrawObject_calculateBroadFrame(drawFunc){var ndx=self.drawQueue.indexOf(drawFunc);while(ndx>=0){self.drawQueue.splice(ndx,1);ndx=self.drawQueue.indexOf(drawFunc)}};self.containsPoint=function Display_DrawObject_hitTest(point){return point.x>=self.frame.left()&&point.x<=self.frame.right()&&point.y>=self.frame.top()&&point.y<=self.frame.bottom()};self.on=function Display_DrawObject_on(eventName,callback){self.dispatcher.on(eventName,callback)};self.off=function Display_DrawObject_off(eventName,callback){self.dispatcher.off(eventName,callback)};self.isListeningFor=function Display_DrawObject_isListeningFor(eventType){return self.dispatcher.isListeningFor(eventType)};return self};return{construct:construct}})();var Sprite=(function createSpriteModule(){var __instances=0;var construct=function Display_Sprite_construct(initObj){initObj=ifndefInitObj(initObj,{src:"",frames:[],image:new Image(),secondsPerFrame:1/12,onerror:function(e){console.log(e)},onload:function(e){}});var src=initObj.src;var startTime=0;var currentFrame=0;var self=Object.addin(DrawObject.construct(),initObj);self.id=self.id+" Sprite-"+__instances++;self.image.onload=initObj.onload;self.image.onerror=initObj.onerror;self.image.src=src;self.toString=function Display_Sprite_toString(){return"[object Sprite]"};self.time=function(){return time};self.startTime=function(){return startTime};self.millisecondsPerFrame=function(){return self.secondsPerFrame*1000};self.currentFrame=function Display_Sprite_currentFrame(time){if(time===null||time===undefined){time=Date.now()}if(!startTime){startTime=time}var endWait=startTime+self.millisecondsPerFrame();if(time>endWait){currentFrame=(++currentFrame)%self.frames.length;startTime=endWait}return currentFrame};var oldDraw=self.draw;self.draw=function Display_Sprite_draw(time){if(!defined(self.context)){throw new Error("Sprite::draw() a drawing context was not provided.")}var frame;if(self.frames.length){frame=self.frames[self.currentFrame(time)]}else{if(self.frame.area()===0){frame=Rectangle.construct(0,0,self.image.width,self.image.height)}else{frame=self.frame.copy()}}var dx=self.frame.origin.x;var dy=self.frame.origin.y;var dw=self.frame.size.width||frame.size.width;var dh=self.frame.size.height||frame.size.height;self.context.drawImage(self.image,frame.origin.x,frame.origin.y,frame.size.width,frame.size.height,dx,dy,dw,dh);oldDraw(time)};return self};return{construct:construct}})();var Stage=(function createStageModule(){var __instances=0;var construct=function Display_Stage_construct(initObj){initObj=ifndefInitObj(initObj,{mousePoint:Point.construct(),children:[]});var self=Object.addin(DrawObject.construct(),initObj);self.id=self.id+" Stage-"+__instances++;self.addChild=function Stage_addChild(child){self.children.push(child);child.context=self.context};self.removeChild=function Stage_addChild(child){var ndx=self.children.indexOf(child);if(ndx>=0){self.children.splice(ndx,1);child.context=null}};self.getChildrenAt=function Stage_getChildrenAt(point){var collection=[self];var n=self.children.length;for(var i=0;i<n;i++){var child=self.children[i];var frame=child.frame;if(frame.containsPoint(point)){collection.push(child)}}return collection};var oldDraw=self.draw;self.draw=function Stage_draw(){self.context.clearRect(0,0,self.context.canvas.width,self.context.canvas.height);oldDraw();var n=self.children.length;for(var i=0;i<n;i++){var child=self.children[i];child.draw()}};var setMousePoint=function Stage_setMousePoint(e){self.mousePoint.x=e.data.nativeEvent.offsetX;self.mousePoint.y=e.data.nativeEvent.offsetY};var propagateMouseEvent=function Stage_propagateMouseEvent(e){setMousePoint(e);var hitObjects=self.getChildrenAt(self.mousePoint);var n=hitObjects.length;for(var i=n-1;i>=1;i--){var child=hitObjects[i];if(child.dispatcher.isListeningFor(e.type)){child.dispatcher.dispatch(e,child)}}return hitObjects};var mousemove=function Stage_mousemove(e){var hitObjects=propagateMouseEvent(e);var n=self.children.length;for(var i=n-1;i>=1;i--){var child=self.children[i];var mousedOver=hitObjects.indexOf(child)>=0;var oldMousedOver=child.mousedOver;var packageEvent=function(e,type){return Event.construct({type:type,data:{nativeEvent:e.nativeEvent}})};child.mousedOver=mousedOver;if(oldMousedOver!==mousedOver){if(oldMousedOver&&!mousedOver&&child.isListeningFor("onmouseout")){var event=packageEvent(e,"onmouseout");child.dispatcher.dispatch(event,child)}else{if(!oldMousedOver&&mousedOver&&child.isListeningFor("onmouseover")){var event=packageEvent(e,"onmouseover");child.dispatcher.dispatch(event,child)}}}}};var mousedown=function Stage_mousedown(e){propagateMouseEvent(e)};var mouseup=function Stage_mouseup(e){propagateMouseEvent(e)};var click=function Stage_click(e){propagateMouseEvent(e)};var resize=function Stage_resize(e){};var keyhandler=function Stage_keyhandler(e){var nativeEvent=e.data.nativeEvent;if(nativeEvent.keyIdentifier){var keyIdentifier=nativeEvent.keyIdentifier;if(keyIdentifier.indexOf("U+")===-1){e.data.character=keyIdentifier}else{var uni='"\\u'+keyIdentifier.substr(2)+'"';e.data.character=eval(uni)}}else{var code=nativeEvent.charCode?nativeEvent.charCode:nativeEvent.keyCode;e.data.character=String.fromCharCode(code)}propagateMouseEvent(e)};self.init=function Display_Stage_init(){var addEvents=function(element,eventNames){eventNames.map(function(eventName){element[eventName]=function Display_Stage_eventPropagator(nativeEvent){var event=Event.construct({type:eventName,data:{nativeEvent:nativeEvent}});self.dispatcher.dispatch(event,self)}})};addEvents(self.context.canvas,["onclick","onmousedown","onmouseup","onmousemove","onresize"]);addEvents(document,["onkeypress","onkeydown","onkeyup"]);self.on("onmousedown",mousedown);self.on("onmouseup",mouseup);self.on("onmousemove",mousemove);self.on("onresize",resize);self.on("onclick",click);self.on("onkeypress",keyhandler);self.on("onkeydown",keyhandler);self.on("onkeyup",keyhandler)};if(self.context){self.init()}return self};return{construct:construct}})();var Utility=(function initUtility(){var self={};self.drawFrameGenerator=function Display_Utility_drawFrameGen(fill,stroke){return function drawFrame(object){if(object.context){object.context.save();object.context.strokeStyle=stroke||"rgba(0, 0, 0, 0)";object.context.fillStyle=fill||"rgba(0, 0, 0, 1.0)";object.context.fillRect(object.frame.left(),object.frame.top(),object.frame.size.width,object.frame.size.height);object.context.strokeRect(object.frame.left(),object.frame.top(),object.frame.size.width,object.frame.size.height);object.context.restore()}}};return self})();return{DrawObject:DrawObject,Sprite:Sprite,Stage:Stage,Utility:Utility,events:events,}})(modules);(function blankCallback(){})(modules);modules.SpriteMaker=(function(imports){var Global=imports.Global;var Point=imports.Point;var Display=imports.Display;var Event=imports.Event;var Rectangle=imports.Rectangle;var construct=function(initObj){initObj=ifndefInitObj(initObj,{id:"SpriteMaker",sprite:null,loaded:false,animationFrames:[]});var self=Object.addin(Display.Stage.construct(),initObj);var frameDrawFunc=function(object){object.context.save();object.context.strokeStyle="rgba(255, 255, 0, 1.0)";object.context.fillStyle="rgba(255, 255, 0, 0.25)";object.context.fillRect(object.frame.left(),object.frame.top(),object.frame.size.width,object.frame.size.height);if(object.outline){object.context.strokeRect(object.frame.left(),object.frame.top(),object.frame.size.width,object.frame.size.height)}var ndx=self.animationFrames.indexOf(object);object.context.font="16px sans-serif";object.context.fillStyle="rgba(0, 0, 0, 0.5)";object.context.fillText(ndx.toString(),object.frame.left()+6,object.frame.top()+16);object.context.restore()};var constructFrame=function(frame){var mouseover,mouseout,animationFrame;mouseover=function(e){animationFrame.outline=true};mouseout=function(e){animationFrame.outline=false};animationFrame=Display.DrawObject.construct({frame:frame});animationFrame.addDrawFunc(frameDrawFunc);animationFrame.outline=false;animationFrame.on("onmouseover",mouseover);animationFrame.on("onmouseout",mouseout);return animationFrame};var drawSelectedFrame=function(object){object.context.save();object.context.strokeStyle="rgb(0, 255, 255)";object.context.strokeRect(object.frame.left(),object.frame.top(),object.frame.size.width,object.frame.size.height);object.context.restore()};self.loadNewSprite=function(path){console.log("SpriteMaker::loadNewSprite() loading new sprite sheet at "+path);self.sprite=Display.Sprite.construct({src:path,onload:function loadNewSpriteLoaded(){console.log("SpriteMaker::loadNewSprite() done!");self.loaded=true}});self.addChild(self.sprite);return self.sprite};self.createNewFrame=function(){var mousedown,mousemove,mouseup,p1,moved,ndx;mousedown=function(e){self.sendOutput("now drag to size the frame");p1=self.mousePoint.copy();self.off("onmousedown",mousedown);self.on("onmousemove",mousemove);self.on("onmouseup",mouseup)};mousemove=function(e){var animationFrame,point,frame;point=self.mousePoint.copy();frame=Rectangle.constructFromTwoPoints(p1,point);animationFrame=constructFrame(frame);if(!moved){moved=true;ndx=self.animationFrames.length;self.animationFrames.push(animationFrame);self.addChild(animationFrame)}self.animationFrames[ndx].frame=frame};mouseup=function(e){self.sendOutput("frame created");self.off("onmousemove",mousemove);self.off("onmouseup",mouseup)};self.on("onmousedown",mousedown);return"click and drag a rectangle over the sprite sheet to place a frame"};self.deleteFrame=function(){var click=function(e){var hitObjects=self.getChildrenAt(self.mousePoint);var target=hitObjects[hitObjects.length-1];if(target!==self){var animationNdx=self.animationFrames.indexOf(target);self.animationFrames.splice(animationNdx,1);self.removeChild(target);self.off("onclick",click);self.sendOutput("frame deleted")}};self.on("onclick",click);return"click on a frame to delete it"};self.resizeFrame=function(){var mouseover,mouseout,mousemove,mouseup,stageClick;var deleteTargetSections;var isResizing=false;deleteTargetSections=function(target){if(target.sections){target.sections.map(function(el,ndx,a){self.removeChild(el)});delete target.sections}};mouseover=function(e,target){if(target.sections){return}var border=10;var frame=target.frame;var sections=frame.section({verticallyAt:[border,frame.size.width-border],horizontallyAt:[border,frame.size.height-border]}).map(function(el,ndx,a){var object=Display.DrawObject.construct({frame:el});var conditionalDraw=Display.Utility.drawFrameGenerator("rgba(255, 255, 0, 1.0)");var drawFunc=function(section){if(section.mousedOver&&!isResizing){conditionalDraw(section)}};object.addDrawFunc(drawFunc);self.addChild(object);var lastPoint=null;var sectionNdx=null;var sectionDown,stageMove,stageUp;sectionDown=function(e,section){isResizing=true;sectionNdx=target.sections.indexOf(section);lastPoint=self.mousePoint.copy();self.on("onmousemove",stageMove);self.on("onmouseup",stageUp)};stageMove=function(e,section){if(!isResizing){return}var moveBy=Point.construct(self.mousePoint.x-lastPoint.x,self.mousePoint.y-lastPoint.y);switch(sectionNdx){case 0:target.frame.origin.x+=moveBy.x;target.frame.origin.y+=moveBy.y;target.frame.size.width-=moveBy.x;target.frame.size.height-=moveBy.y;break;case 1:target.frame.origin.y+=moveBy.y;target.frame.size.height-=moveBy.y;break;case 2:target.frame.origin.y+=moveBy.y;target.frame.size.width+=moveBy.x;target.frame.size.height-=moveBy.y;break;case 3:target.frame.origin.x+=moveBy.x;target.frame.size.width-=moveBy.x;break;case 4:target.frame.origin.x+=moveBy.x;target.frame.origin.y+=moveBy.y;break;case 5:target.frame.size.width+=moveBy.x;break;case 6:target.frame.origin.x+=moveBy.x;target.frame.size.width-=moveBy.x;target.frame.size.height+=moveBy.y;break;case 7:target.frame.size.height+=moveBy.y;break;case 8:target.frame.size.width+=moveBy.x;target.frame.size.height+=moveBy.y;break}lastPoint=self.mousePoint.copy()};stageUp=function(e,section){isResizing=false;deleteTargetSections(target);self.off("onmousemove",stageMove);self.off("onmouseup",stageUp)};object.on("onmousedown",sectionDown);return object});target.sections=sections};mouseout=function(e,target){deleteTargetSections(target)};stageClick=function(e){if(self.getChildrenAt(self.mousePoint).length===1){self.animationFrames.map(function(el,ndx,a){el.off("onmouseover",mouseover);el.off("onmouseout",mouseout)});self.off("onclick",stageClick);self.sendOutput("done resizing")}};self.animationFrames.map(function(el,ndx,a){el.on("onmouseover",mouseover);el.on("onmouseout",mouseout)});self.on("onclick",stageClick);return"mouseover a frame, drag the center region to move or click and drag a border region to resize, click the stage to complete"};self.animate=function SpriteMaker_animate(){var sprite=Display.Sprite.construct({src:self.sprite.src,onload:function SpriteMaker_animate_onload(){self.sendOutput("animating sprite sheet click stage to stop...");self.addChild(sprite)},frames:self.animationFrames.map(function(el,ndx,a){return el.frame}),drawQueue:[function(){sprite.frame.origin.x=self.context.canvas.width/2-sprite.frame.size.width/2;sprite.frame.origin.y=self.context.canvas.height/2-sprite.frame.size.height/2}]});var background=Display.DrawObject.construct({id:"animation background",drawQueue:[Display.Utility.drawFrameGenerator("rgba(255, 255, 255, 0.7)"),function(){background.frame=self.frame.copy()}]});self.addChild(background);var cleanup=function(e){self.removeChild(sprite);self.removeChild(background);self.off("onclick",cleanup);self.sendOutput("animation stopped")};self.on("onclick",cleanup);return"reloading sprite sheet..."};self.alignFrames=function(){var selectedFrames=[];var downStage=function(){var hitObjects=self.getChildrenAt(self.mousePoint);if(hitObjects.length===1){self.off("onclick",downStage);var alignHorizontal=function(){for(var i=1;i<selectedFrames.length;i++){selectedFrames[i].frame.origin.x=selectedFrames[0].frame.origin.x}};var alignVertical=function(){for(var i=1;i<selectedFrames.length;i++){selectedFrames[i].frame.origin.y=selectedFrames[0].frame.origin.y}};var cleanup=function(){selectedFrames.map(function(frame){frame.removeDrawFunc(drawSelectedFrame)});self.off("onkeydown",selectAlignOption);self.sendOutput("frames aligned")};var selectAlignOption=function(e){switch(e.data.character){case"H":alignHorizontal();cleanup();break;case"V":alignVertical();cleanup();break;default:self.sendOutput('please type "H" or "V" (you typed "'+e.character+'")')}};self.on("onkeydown",selectAlignOption);self.sendOutput('type "H" to align horizontally and "V" to align vertically');return}var frame=hitObjects.pop();var ndx=selectedFrames.indexOf(frame);if(ndx>=0){return}selectedFrames.push(frame);frame.addDrawFunc(drawSelectedFrame)};self.on("onclick",downStage);return"select frames to align by clicking on them, then click the stage"};self.createSprite=function(){return Display.Sprite.construct({src:self.sprite.src,frames:self.animationFrames.map(function(el){return el.frame})})};self.printCode=function(){var code="Display.Sprite.construct({\n";code+="	src : '"+self.sprite.src+"',\n";code+="	frames : [\n";self.animationFrames.map(function(el,ndx,a){var x,y,w,h;x=el.frame.origin.x;y=el.frame.origin.y;w=el.frame.size.width;h=el.frame.size.height;code+="		Rectangle.construct("+x+","+y+","+w+","+h+"),\n"});code+="	],\n";code+="});";console.log("\n",code);return"code printed to javascript console"};self.frameByFrame=function(){var sprite=self.createSprite();self.addChild(sprite);self.addDrawFunc(function(){sprite.frame.origin=Point.construct(self.sprite.image.width,0);sprite.frames=self.animationFrames.map(function(el){return el.frame})})};var oldInit=self.init;self.init=function(){var toolbar,addFrameButton,canvas,output;canvas=document.createElement("canvas");canvas.id="canvas";var context=self.context=canvas.getContext("2d");var setDimensions=function(){canvas.width=window.innerWidth;canvas.height=window.innerHeight-canvas.offsetTop};setDimensions();window.onresize=function(e){setDimensions()};oldInit();self.sendOutput=function(msg){output.innerHTML=msg};toolbar=document.createElement("div");toolbar.id="toolbar";toolbar.style.cssText="width:100%; height:1em; padding:0.5em 0em; background:#000; color:#7F7F7F";var addButton=function(label,func,shortCut){var button=document.createElement("a");button.href="#";button.innerHTML=" "+label+" ";button.onclick=function(e){self.sendOutput(func.apply(self));return false};toolbar.appendChild(button);self.on("onkeydown",function buttonShortCut(e){if(e.data.character===shortCut&&e.data.nativeEvent.ctrlKey===true){button.onclick()}})};var addSpacer=(function(){var spacerCount=0;return function(){var spacer=document.createElement("span");spacer.id="toolbar_spacer_"+spacerCount.toString();spacer.innerHTML=" ";spacer.style.cssText="margin-left:1em;";toolbar.appendChild(spacer)}})();addButton("+frame",self.createNewFrame,"F");addButton("-frame",self.deleteFrame,"D");addButton("[]frame",self.resizeFrame,"R");addButton("^frame",self.alignFrames,"A");addButton("animate",self.animate,"Enter");addButton("print",self.printCode,"P");output=document.createElement("div");output.id="output";output.style.cssText="background:#E0E0E0; position:absolute; bottom:0px; left:0px; padding:0.5em";output.innerHTML="output goes here";document.body.appendChild(toolbar);document.body.appendChild(canvas);document.body.appendChild(output);animateWithFunction(self.step)};self.addDrawFunc(function(){self.context.save();self.context.fillStyle="rgba(0, 0, 0, 0.25)";self.context.fillRect(0,0,self.context.canvas.width,self.context.canvas.height);self.context.restore()});self.step=function(time){self.frame.size.width=self.context.canvas.width;self.frame.size.height=self.context.canvas.height;self.draw()};return self};return{construct:construct}})(modules);(function blankCallback(){})(modules);modules.main=(function initMain(imports){var spriteMaker=window.sm=imports.SpriteMaker.construct();spriteMaker.init();spriteMaker.loadNewSprite("../../images/sprites/crabtank.png")})(modules);(function blankCallback(){})(modules)};
        </script>
	</body>
</html>
